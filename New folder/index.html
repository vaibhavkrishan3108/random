<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday!</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="cinematic-index.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&family=Dancing+Script:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/typewriter-effect@2.19.0/dist/core.js"></script>
</head>
<body class="dark-page">
    <!-- Loading animation -->
    <div class="loading-animation" id="loading-animation">
        <div class="loading-heart">❤️</div>
    </div>

    <!-- Particles background container -->
    <div id="particles-js"></div>
    
    <!-- Spotlight effect -->
    <div class="spotlight"></div>
    
    <!-- Floating elements -->
    <div class="floating-element floating-heart" style="top: 15%; left: 10%; animation-delay: 0s;">❤️</div>
    <div class="floating-element floating-heart" style="top: 25%; left: 85%; animation-delay: 1.5s;">💗</div>
    <div class="floating-element floating-heart" style="top: 60%; left: 20%; animation-delay: 0.7s;">💕</div>
    <div class="floating-element floating-heart" style="top: 70%; left: 80%; animation-delay: 2.1s;">💖</div>
    <div class="floating-element floating-heart" style="top: 40%; left: 5%; animation-delay: 1.1s;">💓</div>
    <div class="floating-element floating-heart" style="top: 35%; left: 90%; animation-delay: 0.3s;">💘</div>
    
    <!-- Opening scene content -->
    <div class="opening-container">
        <div class="typewriter-container">
            <div id="typewriter"></div>
        </div>
        
        <!-- Countdown Timer -->
        <div class="countdown-container" id="countdown-container">
            <div class="countdown-box">
                <div class="countdown-number" id="countdown-days">00</div>
                <div class="countdown-label">Days</div>
            </div>
            <div class="countdown-separator">:</div>
            <div class="countdown-box">
                <div class="countdown-number" id="countdown-hours">00</div>
                <div class="countdown-label">Hours</div>
            </div>
            <div class="countdown-separator">:</div>
            <div class="countdown-box">
                <div class="countdown-number" id="countdown-minutes">00</div>
                <div class="countdown-label">Minutes</div>
            </div>
            <div class="countdown-separator">:</div>
            <div class="countdown-box">
                <div class="countdown-number" id="countdown-seconds">00</div>
                <div class="countdown-label">Seconds</div>
            </div>
        </div>
        
        <div class="button-container visible" id="surprise-button">
            <button class="glow-button disabled" id="unwrap-button" disabled>Click to unwrap your surprise 🎁</button>
        </div>
    </div>

    <script>
        // Hide loading animation after preloading completes
        window.addEventListener('load', function() {
            setTimeout(function() {
                gsap.to('#loading-animation', {
                    opacity: 0,
                    duration: 1,
                    onComplete: () => {
                        document.getElementById('loading-animation').style.display = 'none';
                    }
                });
            }, 1500);
        });
        
        // Countdown Timer for August 15th, 2025 (IST)
        function updateCountdown() {
            // Target date: August 15th, 2025 at 00:00:00 IST (UTC+5:30)
            const targetDate = new Date('2025-08-15T00:15:00+05:30');
            const currentDate = new Date();
            
            // Calculate time difference
            const difference = targetDate - currentDate;
            
            // Get button element
            const unwrapButton = document.getElementById('unwrap-button');
            
            // Check if target date has passed
            if (difference <= 0) {
                document.getElementById('countdown-days').textContent = '00';
                document.getElementById('countdown-hours').textContent = '00';
                document.getElementById('countdown-minutes').textContent = '00';
                document.getElementById('countdown-seconds').textContent = '00';
                
                // Enable button when countdown is complete
                if (unwrapButton.disabled) {
                    unwrapButton.disabled = false;
                    unwrapButton.classList.remove('disabled');
                    
                    // Add celebration animation to the button
                    gsap.to(unwrapButton, {
                        scale: 1.1,
                        duration: 0.5,
                        repeat: 3,
                        yoyo: true,
                        ease: "power2.inOut",
                        onComplete: () => {
                            gsap.to(unwrapButton, {
                                scale: 1,
                                duration: 0.3
                            });
                        }
                    });
                }
                return;
            }
            
            // Calculate remaining time
            const days = Math.floor(difference / (1000 * 60 * 60 * 24));
            const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((difference % (1000 * 60)) / 1000);
            
            // Update the countdown
            document.getElementById('countdown-days').textContent = days.toString().padStart(2, '0');
            document.getElementById('countdown-hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('countdown-minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('countdown-seconds').textContent = seconds.toString().padStart(2, '0');
            
            // Add subtle animation to changing numbers
            if (seconds % 2 === 0) {
                gsap.fromTo('#countdown-seconds', 
                    { scale: 1.05, textShadow: '0 0 20px rgba(255, 255, 255, 0.7)' },
                    { scale: 1, textShadow: '0 0 15px rgba(255, 255, 255, 0.5)', duration: 0.5 }
                );
            }
            
            // Add more prominent animation when minutes change
            if (seconds === 0) {
                gsap.fromTo('#countdown-minutes',
                    { scale: 1.1, textShadow: '0 0 25px rgba(255, 255, 255, 0.8)' },
                    { scale: 1, textShadow: '0 0 15px rgba(255, 255, 255, 0.5)', duration: 0.7 }
                );
            }
        }
        
        // Function to set a demo countdown that's close to ending (for testing)
        function setDemoCountdown() {
            // Uncomment this line to test the countdown expiration
            // const targetDate = new Date(Date.now() + 10000); // 10 seconds from now
            // localStorage.setItem('customTargetDate', targetDate.toISOString());
        }
        
        // Call this function once to set up a demo countdown if needed
        // setDemoCountdown();
        
        // Update countdown every second
        setInterval(updateCountdown, 1000);
        
        // Initial call to display countdown immediately
        updateCountdown();
    
        // Initialize particles.js
        particlesJS.load('particles-js', 'particles.json', function() {
            console.log('Particles loaded...');
        });

        // Animate floating hearts
        const hearts = document.querySelectorAll('.floating-heart');
        hearts.forEach((heart, index) => {
            gsap.to(heart, {
                y: -20,
                duration: 2 + (index % 3),
                repeat: -1,
                yoyo: true,
                ease: "sine.inOut",
                delay: index * 0.2
            });
        });

        // Typewriter effect
        window.onload = function() {
            setTimeout(function() {
                const typewriter = new Typewriter('#typewriter', {
                    strings: ['Pssst... Someone very special has a birthday today.'],
                    autoStart: true,
                    loop: false,
                    delay: 80,
                    cursor: '❤️'
                });
                
                typewriter.start();
                
                // Animate the button which is already visible
                gsap.from("#surprise-button", {
                    duration: 1,
                    scale: 0.8,
                    opacity: 0,
                    ease: "back.out(1.7)",
                    delay: 0.5
                });
            }, 2000);
        };

        // Button event
        document.getElementById('unwrap-button').addEventListener('click', function() {
            // Add click animation
            gsap.to(this, {
                scale: 0.95,
                duration: 0.1,
                onComplete: () => {
                    gsap.to(this, {
                        scale: 1,
                        duration: 0.1
                    });
                }
            });
            
            // Fade out content
            gsap.to('.opening-container', {
                opacity: 0,
                duration: 1,
                onComplete: () => {
                    window.location.href = 'celebration.html';
                }
            });
        });
        
        // Create mouse follow effect for spotlight
        document.addEventListener('mousemove', function(e) {
            const spotlight = document.querySelector('.spotlight');
            if (spotlight) {
                const x = e.clientX / window.innerWidth;
                const y = e.clientY / window.innerHeight;
                
                spotlight.style.background = `radial-gradient(circle at ${x * 100}% ${y * 100}%, rgba(0,0,0,0.4) 0%, rgba(0,0,0,0.8) 70%)`;
            }
        });
    </script>
</body>
</html>
